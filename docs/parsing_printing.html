<html><head><title>xml-lens</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="net.michalsitko" /><meta name="description" content="XML Optics library for Scala" /><meta name="og:image" content="/xml-lens/img/poster.png" /><meta name="og:title" content="xml-lens" /><meta name="og:site_name" content="xml-lens" /><meta name="og:url" content="http://note.github.io/xml-lens" /><meta name="og:type" content="website" /><meta name="og:description" content="XML Optics library for Scala" /><link rel="icon" type="image/png" href="/xml-lens/img/favicon.png" /><meta name="twitter:title" content="xml-lens" /><meta name="twitter:image" content="http://note.github.io/xml-lensimg/poster.png" /><meta name="twitter:description" content="XML Optics library for Scala" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/xml-lens/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/xml-lens/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/xml-lens/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/xml-lens/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/xml-lens/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/xml-lens/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/xml-lens/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/xml-lens/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/xml-lens/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/xml-lens/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/xml-lens/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/xml-lens/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/xml-lens/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/xml-lens/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/xml-lens/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/xml-lens/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/xml-lens/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/xml-lens/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/xml-lens/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/xml-lens/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/xml-lens/highlight/styles/default.css" /><link rel="stylesheet" href="/xml-lens/css/style.css" /><link rel="stylesheet" href="/xml-lens/css/palette.css" /><link rel="stylesheet" href="/xml-lens/css/codemirror.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/xml-lens/" class="brand"><div class="brand-wrapper"><span>xml-lens</span></div></a></li> <li><a href="/xml-lens/index.html#quick_start" class="">Quick start</a></li> <li><a href="/xml-lens/docs/cookbook.html" class="">Cookbook</a></li> <li><a href="/xml-lens/docs/modularity.html" class="">Modularity</a></li> <li><a href="/xml-lens/docs/parsing_printing.html" class="">Parsing/Printing</a></li> <li><a href="/xml-lens/docs/namespaces.html" class="">Namespaces</a></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/note/xml-lens"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/note/xml-lens"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li><li><a href="#" onclick="shareSiteTwitter('xml-lens XML Optics library for Scala');"><i class="fa fa-twitter"></i></a></li><li><a href="#" onclick="shareSiteFacebook('xml-lens XML Optics library for Scala');"><i class="fa fa-facebook"></i></a></li><li><a href="#" onclick="shareSiteGoogle();"><i class="fa fa-google-plus"></i></a></li></ul></div></div></div></div><div id="content" data-github-owner="note" data-github-repo="xml-lens"><div class="content-wrapper"><section><h2 id="parsing">Parsing</h2>

<p>You need to have <code class="highlighter-rouge">xml-lens-io</code> included.</p>

<p>For JVM platform <code class="highlighter-rouge">xml-lens-io</code> uses <code class="highlighter-rouge">javax.xml.stream.XMLStreamReader</code>. To include it in your build add the following to 
your <code class="highlighter-rouge">build.sbt</code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>libraryDependencies += "net.michalsitko" %% "xml-lens-io" % xmlLensVersion
</code></pre></div></div>

<p>For JS platform slightly modified version of <a href="https://github.com/isaacs/sax-js">sax-js</a> is used underneath. To include it
in your build add the following to your <code class="highlighter-rouge">build.sbt</code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>libraryDependencies += "net.michalsitko" %%% "xml-lens-io" % xmlLensVersion
</code></pre></div></div>

<p>After you included <code class="highlighter-rouge">io</code> module to your project parsing XML boils down to:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">net.michalsitko.xml.parsing.XmlParser</span>
<span class="c1">// import net.michalsitko.xml.parsing.XmlParser
</span>
<span class="k">val</span> <span class="n">input</span> <span class="k">=</span> <span class="s">"&lt;a&gt;&lt;b&gt;this is xml&lt;/b&gt;&lt;/a&gt;"</span>
<span class="c1">// input: String = &lt;a&gt;&lt;b&gt;this is xml&lt;/b&gt;&lt;/a&gt;
</span>
<span class="nc">XmlParser</span><span class="o">.</span><span class="n">parse</span><span class="o">(</span><span class="n">input</span><span class="o">)</span>
<span class="c1">// res0: Either[net.michalsitko.xml.parsing.ParsingException,net.michalsitko.xml.entities.XmlDocument] = Right(XmlDocument(Prolog(None,Vector(),None),LabeledElement(ResolvedName(,,a),Element(Vector(),List(LabeledElement(ResolvedName(,,b),Element(Vector(),List(Text(this is xml)),Vector()))),Vector()))))
</span></code></pre></div></div>

<h3 id="differences-between-jvm-and-js">Differences between JVM and JS</h3>

<h4 id="parsing-entity-references">Parsing entity references</h4>

<p>On JVM following input:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">input</span> <span class="k">=</span>
    <span class="s">"""&lt;?xml version="1.0" encoding="UTF-8"?&gt;
      |&lt;!DOCTYPE html
      |    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
      |    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"
      |[
      |    &lt;!ENTITY test-entity "This &lt;em&gt;is&lt;/em&gt; an entity."&gt;
      |]&gt;&lt;html&gt;&lt;body&gt;&lt;p&gt;abc &amp;test-entity; def&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;"""</span><span class="o">.</span><span class="n">stripMargin</span>
</code></pre></div></div>

<p>After parsing, element <code class="highlighter-rouge">p</code> will have 3 children:</p>

<p><code class="highlighter-rouge">(Text("abc "), EntityReference("test-entity", "This &lt;em&gt;is&lt;/em&gt; an entity."), Text(" def"))</code></p>

<p>As you can see parser created <code class="highlighter-rouge">EntityReference</code> which holds both name of the entity and the replacement. This is the default
behavior as it does not lose any information which is especially useful if you want to make non-intrusive changes
and print back document as similar to original as itâ€™s possible. Read more about configuring this behavior at 
<a href="#parsing-configuration">parsing configuration</a>.</p>

<h3 id="parsing-configuration">Parsing configuration</h3>

<p><em>At the moment only JVM parser is configurable.</em> Configuration is done by passing implicit parameter of type
<code class="highlighter-rouge">ParserConfig</code> to <code class="highlighter-rouge">XmlParser.parse</code> method. If no configuration is accessible in scope <code class="highlighter-rouge">ParserConfig.Default</code> is used.</p>

<h4 id="replaceentityreferences"><code class="highlighter-rouge">replaceEntityReferences</code></h4>

<p>As of now the only <code class="highlighter-rouge">ParserConfig</code> has only one property - <code class="highlighter-rouge">replaceEntityReferences</code>. It controls how entity references
are parsed. The default value is <code class="highlighter-rouge">false</code>. What result is expected in that case was described in <a href="#parsing-entity-references">Parsing entity references</a>.
Here we focus on <code class="highlighter-rouge">replaceEntityReferences = true</code> case.</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">input</span> <span class="k">=</span>
    <span class="s">"""&lt;?xml version="1.0" encoding="UTF-8"?&gt;
      |&lt;!DOCTYPE html
      |    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
      |    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"
      |[
      |    &lt;!ENTITY test-entity "This &lt;em&gt;is&lt;/em&gt; an entity."&gt;
      |]&gt;&lt;html&gt;&lt;body&gt;&lt;p&gt;abc &amp;test-entity; def&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;"""</span><span class="o">.</span><span class="n">stripMargin</span>
      
<span class="k">import</span> <span class="nn">net.michalsitko.xml.parsing.ParserConfig</span>

<span class="k">implicit</span> <span class="k">val</span> <span class="n">cfg</span> <span class="k">=</span> <span class="nc">ParserConfig</span><span class="o">.</span><span class="nc">Default</span><span class="o">.</span><span class="n">copy</span><span class="o">(</span><span class="n">replaceEntityReferences</span> <span class="k">=</span> <span class="kc">true</span><span class="o">)</span>

<span class="nc">XmlParser</span><span class="o">.</span><span class="n">parse</span><span class="o">(</span><span class="n">input</span><span class="o">)</span>
</code></pre></div></div>

<p>When parsed, element <code class="highlighter-rouge">p</code> will have just one child:</p>

<p><code class="highlighter-rouge">Text("abc This &lt;em&gt;is&lt;/em&gt; an entity. def")</code></p>

<h2 id="printing">Printing</h2>

<p>You need to have <code class="highlighter-rouge">xml-lens-io</code> included.</p>

<p>To add it to your build add following to your <code class="highlighter-rouge">build.sbt</code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>libraryDependencies += "net.michalsitko" %% "xml-lens-io" % xmlLensVersion
</code></pre></div></div>

<p>Or (in case of scala.js build):</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>libraryDependencies += "net.michalsitko" %%% "xml-lens-io" % xmlLensVersion
</code></pre></div></div>

<p>The same printing code written in Scala is used for both JVM and JS. Thus, no differences between platforms is expected
in terms of printing.</p>

<p>To print XML:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">net.michalsitko.xml.entities.</span><span class="o">{</span><span class="nc">LabeledElement</span><span class="o">,</span> <span class="nc">XmlDocument</span><span class="o">}</span>
<span class="c1">// import net.michalsitko.xml.entities.{LabeledElement, XmlDocument}
</span>
<span class="k">import</span> <span class="nn">net.michalsitko.xml.printing.XmlPrinter</span>
<span class="c1">// import net.michalsitko.xml.printing.XmlPrinter
</span>
<span class="k">val</span> <span class="n">document</span> <span class="k">=</span> <span class="nc">XmlDocument</span><span class="o">.</span><span class="n">noProlog</span><span class="o">(</span><span class="nc">LabeledElement</span><span class="o">.</span><span class="n">unprefixed</span><span class="o">(</span><span class="s">"root"</span><span class="o">))</span>
<span class="c1">// document: net.michalsitko.xml.entities.XmlDocument = XmlDocument(Prolog(None,List(),None),LabeledElement(ResolvedName(,,root),Element(List(),List(),List())))
</span>
<span class="nc">XmlPrinter</span><span class="o">.</span><span class="n">print</span><span class="o">(</span><span class="n">document</span><span class="o">)</span>
<span class="c1">// res5: String = &lt;root&gt;&lt;/root&gt;
</span></code></pre></div></div>

<h3 id="printing-configuration">Printing configuration</h3>

<p>Some behaviors of <code class="highlighter-rouge">XmlPrinter.print</code> can be configured with <code class="highlighter-rouge">PrinterConfig</code>. It can be passed as implicit parameter.
When no implicit config can be found <code class="highlighter-rouge">PrinterConfig.Default</code> is used. To find out more about <code class="highlighter-rouge">PrinterConfig</code> please
read API docs of it.</p>

<h3 id="printing-cookbook">Printing cookbook</h3>

<h4 id="how-to-print-back-output-which-is-possibly-the-most-similar-to-input">How to print back output which is possibly the most similar to input</h4>

<p>There may be situations in which you want to introduce as few formatting changes as possible. In fact default
configurations for both parser and printer are well suited for that purpose so the following code will do that:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">net.michalsitko.xml.parsing.XmlParser</span>
<span class="c1">// import net.michalsitko.xml.parsing.XmlParser
</span>
<span class="k">import</span> <span class="nn">net.michalsitko.xml.printing.XmlPrinter</span>
<span class="c1">// import net.michalsitko.xml.printing.XmlPrinter
</span>
<span class="c1">// xml formatting is strange here, let's assume we want to keep it
</span><span class="k">val</span> <span class="n">input</span> <span class="k">=</span> <span class="s">"""|&lt;a someAttr="someVal"&gt;
               |       &lt;b&gt;someText  &lt;/b&gt;
               |&lt;c&gt;otherText&lt;/c&gt;&lt;/a&gt;"""</span><span class="o">.</span><span class="n">stripMargin</span>
<span class="c1">// input: String =
// &lt;a someAttr="someVal"&gt;
//        &lt;b&gt;someText  &lt;/b&gt;
// &lt;c&gt;otherText&lt;/c&gt;&lt;/a&gt;
</span>
<span class="nc">XmlParser</span><span class="o">.</span><span class="n">parse</span><span class="o">(</span><span class="n">input</span><span class="o">).</span><span class="n">map</span> <span class="o">{</span> <span class="n">doc</span> <span class="k">=&gt;</span>
  <span class="nc">XmlPrinter</span><span class="o">.</span><span class="n">print</span><span class="o">(</span><span class="n">doc</span><span class="o">)</span>
<span class="o">}</span>
<span class="c1">// res7: scala.util.Either[net.michalsitko.xml.parsing.ParsingException,String] =
// Right(&lt;a someAttr="someVal"&gt;
//        &lt;b&gt;someText  &lt;/b&gt;
// &lt;c&gt;otherText&lt;/c&gt;&lt;/a&gt;)
</span></code></pre></div></div>

<h4 id="how-to-pretty-print">How to pretty print</h4>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">net.michalsitko.xml.parsing.XmlParser</span>
<span class="c1">// import net.michalsitko.xml.parsing.XmlParser
</span>
<span class="k">import</span> <span class="nn">net.michalsitko.xml.printing.</span><span class="o">{</span><span class="nc">Indent</span><span class="o">,</span> <span class="nc">PrinterConfig</span><span class="o">,</span> <span class="nc">XmlPrinter</span><span class="o">}</span>
<span class="c1">// import net.michalsitko.xml.printing.{Indent, PrinterConfig, XmlPrinter}
</span>
<span class="c1">// xml formatting is strange here, let's assume we want to keep it
</span><span class="k">val</span> <span class="n">input</span> <span class="k">=</span> <span class="s">"""|&lt;a someAttr="someVal"&gt;
               |       &lt;b&gt;someText  &lt;/b&gt;
               |&lt;c&gt;otherText&lt;/c&gt;&lt;/a&gt;"""</span><span class="o">.</span><span class="n">stripMargin</span>
<span class="c1">// input: String =
// &lt;a someAttr="someVal"&gt;
//        &lt;b&gt;someText  &lt;/b&gt;
// &lt;c&gt;otherText&lt;/c&gt;&lt;/a&gt;
</span>
<span class="nc">XmlParser</span><span class="o">.</span><span class="n">parse</span><span class="o">(</span><span class="n">input</span><span class="o">).</span><span class="n">map</span> <span class="o">{</span> <span class="n">doc</span> <span class="k">=&gt;</span>
  <span class="k">implicit</span> <span class="k">val</span> <span class="n">printCfg</span> <span class="k">=</span> <span class="nc">PrinterConfig</span><span class="o">.</span><span class="nc">Default</span><span class="o">.</span><span class="n">copy</span><span class="o">(</span><span class="n">indent</span> <span class="k">=</span> <span class="nc">Indent</span><span class="o">.</span><span class="nc">IndentWith</span><span class="o">(</span><span class="s">"  "</span><span class="o">))</span>
  <span class="nc">XmlPrinter</span><span class="o">.</span><span class="n">print</span><span class="o">(</span><span class="n">doc</span><span class="o">)</span>
<span class="o">}</span>
<span class="c1">// res9: scala.util.Either[net.michalsitko.xml.parsing.ParsingException,String] =
// Right(&lt;a someAttr="someVal"&gt;
//   &lt;b&gt;someText  &lt;/b&gt;
//   &lt;c&gt;otherText&lt;/c&gt;
// &lt;/a&gt;)
</span></code></pre></div></div>

<h4 id="how-to-print-minimized-xml">How to print minimized XML</h4>

<p><code class="highlighter-rouge">xml-lens</code> takes a little bit unusual approach to minimization and considers it not a property of printing but a 
transformation performed on document structure (i.e. AST). It does so partially because XML is in theory whitespace
sensitive and thus treating whitespaces as printing details does not seem appropriate.</p>

<p>In short to parse XML, minimize it and print it back you need to:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">net.michalsitko.xml.printing.XmlPrinter</span>
<span class="c1">// import net.michalsitko.xml.printing.XmlPrinter
</span>
<span class="k">import</span> <span class="nn">net.michalsitko.xml.printing.XmlPrinter</span>
<span class="c1">// import net.michalsitko.xml.printing.XmlPrinter
</span>
<span class="k">import</span> <span class="nn">net.michalsitko.xml.syntax.document._</span>
<span class="c1">// import net.michalsitko.xml.syntax.document._
</span>
<span class="c1">// xml formatting is strange here, let's assume we don't care about it and want to have some minimized output
</span><span class="k">val</span> <span class="n">input</span> <span class="k">=</span> <span class="s">"""|&lt;a someAttr="someVal"&gt;
               |       &lt;b&gt;someText  &lt;/b&gt;
               |&lt;c&gt;otherText&lt;/c&gt;&lt;/a&gt;"""</span><span class="o">.</span><span class="n">stripMargin</span>
<span class="c1">// input: String =
// &lt;a someAttr="someVal"&gt;
//        &lt;b&gt;someText  &lt;/b&gt;
// &lt;c&gt;otherText&lt;/c&gt;&lt;/a&gt;
</span>
<span class="nc">XmlParser</span><span class="o">.</span><span class="n">parse</span><span class="o">(</span><span class="n">input</span><span class="o">).</span><span class="n">map</span> <span class="o">{</span> <span class="n">doc</span> <span class="k">=&gt;</span>
  <span class="k">val</span> <span class="n">minimized</span> <span class="k">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">minimize</span>
  <span class="nc">XmlPrinter</span><span class="o">.</span><span class="n">print</span><span class="o">(</span><span class="n">minimized</span><span class="o">)</span>
<span class="o">}</span>
<span class="c1">// res11: scala.util.Either[net.michalsitko.xml.parsing.ParsingException,String] = Right(&lt;a someAttr="someVal"&gt;&lt;b&gt;someText  &lt;/b&gt;&lt;c&gt;otherText&lt;/c&gt;&lt;/a&gt;)
</span></code></pre></div></div>
</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/xml-lens/highlight/highlight.pack.js"></script><script>hljs.configure({
languages:['scala','java','bash']
});
hljs.initHighlighting();
             </script><script src="/xml-lens/js/main.js"></script></body></html>